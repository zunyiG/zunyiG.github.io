<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>构造过程抽象 | Keep learning</title>
    <meta name="description" content="keep learning">
    
    
    <link rel="preload" href="/assets/css/0.styles.ef148202.css" as="style"><link rel="preload" href="/assets/js/app.67e7f428.js" as="script"><link rel="preload" href="/assets/js/3.1660a1d9.js" as="script"><link rel="prefetch" href="/assets/js/10.9e81d398.js"><link rel="prefetch" href="/assets/js/11.677d4ba6.js"><link rel="prefetch" href="/assets/js/12.51d6780b.js"><link rel="prefetch" href="/assets/js/13.a1724e18.js"><link rel="prefetch" href="/assets/js/14.28dd4294.js"><link rel="prefetch" href="/assets/js/15.f2a7689f.js"><link rel="prefetch" href="/assets/js/16.cd9f0474.js"><link rel="prefetch" href="/assets/js/17.3640e356.js"><link rel="prefetch" href="/assets/js/18.0e89fc94.js"><link rel="prefetch" href="/assets/js/19.660c385c.js"><link rel="prefetch" href="/assets/js/2.c18e3c75.js"><link rel="prefetch" href="/assets/js/20.a70e4495.js"><link rel="prefetch" href="/assets/js/21.b7b4380c.js"><link rel="prefetch" href="/assets/js/22.7fe8571d.js"><link rel="prefetch" href="/assets/js/23.9c246f12.js"><link rel="prefetch" href="/assets/js/24.4ebab5c7.js"><link rel="prefetch" href="/assets/js/25.e0f6c8dc.js"><link rel="prefetch" href="/assets/js/26.667a1084.js"><link rel="prefetch" href="/assets/js/27.484b1e43.js"><link rel="prefetch" href="/assets/js/28.e08b6058.js"><link rel="prefetch" href="/assets/js/29.0901b7fb.js"><link rel="prefetch" href="/assets/js/30.5c5cb9f5.js"><link rel="prefetch" href="/assets/js/31.381f1dec.js"><link rel="prefetch" href="/assets/js/32.8f68533f.js"><link rel="prefetch" href="/assets/js/33.74cd6521.js"><link rel="prefetch" href="/assets/js/34.9d137b36.js"><link rel="prefetch" href="/assets/js/35.50b3f97d.js"><link rel="prefetch" href="/assets/js/36.1ba216f1.js"><link rel="prefetch" href="/assets/js/37.39b36aaf.js"><link rel="prefetch" href="/assets/js/38.d86ece5f.js"><link rel="prefetch" href="/assets/js/39.ed51f794.js"><link rel="prefetch" href="/assets/js/4.46657140.js"><link rel="prefetch" href="/assets/js/40.d1f5f3e3.js"><link rel="prefetch" href="/assets/js/41.cfb412eb.js"><link rel="prefetch" href="/assets/js/42.4e699448.js"><link rel="prefetch" href="/assets/js/43.e22ec204.js"><link rel="prefetch" href="/assets/js/44.0421ffff.js"><link rel="prefetch" href="/assets/js/45.58b817ec.js"><link rel="prefetch" href="/assets/js/46.541083b5.js"><link rel="prefetch" href="/assets/js/5.12d27dc6.js"><link rel="prefetch" href="/assets/js/6.25c40935.js"><link rel="prefetch" href="/assets/js/7.0b9bcdd6.js"><link rel="prefetch" href="/assets/js/8.c8621244.js"><link rel="prefetch" href="/assets/js/9.5e4b7b3b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ef148202.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Keep learning</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/computer-program/" class="sidebar-link">计算机程序构造和解释</a></li><li><a href="/computer-program/01.abstraction-process-building.html" class="active sidebar-link">构造过程抽象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#程序设计的基本元素" class="sidebar-link">程序设计的基本元素</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#表达式" class="sidebar-link">表达式</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#命名和环境" class="sidebar-link">命名和环境</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#组合式的求值" class="sidebar-link">组合式的求值</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#复合过程" class="sidebar-link">复合过程</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程应用的代换模型-正则序，应用序" class="sidebar-link">过程应用的代换模型 - 正则序，应用序</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#应用序和正则序" class="sidebar-link">应用序和正则序</a></li></ul></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#条件表达式" class="sidebar-link">条件表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#test-1-5-解析" class="sidebar-link">test 1.5 解析</a></li></ul></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#实例：采用牛顿法求平方根" class="sidebar-link">实例：采用牛顿法求平方根</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程作为黑箱抽象" class="sidebar-link">过程作为黑箱抽象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#局部名" class="sidebar-link">局部名</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#内部定义和块结构" class="sidebar-link">内部定义和块结构</a></li></ul></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程与他们所产生的计算" class="sidebar-link">过程与他们所产生的计算</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#线性递归和迭代" class="sidebar-link">线性递归和迭代</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#树形递归" class="sidebar-link">树形递归</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#增长阶" class="sidebar-link">增长阶</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#求幂" class="sidebar-link">求幂</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#最大公约数" class="sidebar-link">最大公约数</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#质数检测" class="sidebar-link">质数检测</a></li></ul></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#用高阶函数做抽象" class="sidebar-link">用高阶函数做抽象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程作为参数" class="sidebar-link">过程作为参数</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#用lambda构造过程" class="sidebar-link">用lambda构造过程</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程作为一般性方法" class="sidebar-link">过程作为一般性方法</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#通过区间折半寻找方程的根" class="sidebar-link">通过区间折半寻找方程的根</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#寻找函数不动点" class="sidebar-link">寻找函数不动点</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#过程作为返回值" class="sidebar-link">过程作为返回值</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#牛顿法" class="sidebar-link">牛顿法</a></li><li class="sidebar-sub-header"><a href="/computer-program/01.abstraction-process-building.html#抽象和第一级过程" class="sidebar-link">抽象和第一级过程</a></li></ul></li></ul></li><li><a href="/computer-program/02.abstraction-data-building.html" class="sidebar-link">构造数据抽象</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="构造过程抽象"><a href="#构造过程抽象" aria-hidden="true" class="header-anchor">#</a> 构造过程抽象</h1> <h2 id="程序设计的基本元素"><a href="#程序设计的基本元素" aria-hidden="true" class="header-anchor">#</a> 程序设计的基本元素</h2> <p>一个强有力的程序语言，不仅是一种指挥计算机执行任务的方式，还应该是一种框架，使我们能够组织自己的有关计算过程的思想。<br>
当我们在了解一门语言时，要着重了解关于能够将简单认识组合起来形成复杂认识的方法的这方面。为此语言一般提供了三种机制：</p> <ul><li>基本表达式
用于表达语言最关心的简单的个体</li> <li>组合的方法
通过他们可以从简单的个体出发构造出复合的元素</li> <li>抽象的方法
通过他们可以为复合对象命名，并将它们作为单元去操作</li></ul> <h2 id="表达式"><a href="#表达式" aria-hidden="true" class="header-anchor">#</a> 表达式</h2> <ul><li>数字</li> <li>基本表达式
<code>+, -, \*, /</code></li> <li>组合式
<code>1 + 1, 5 \* 5, (1 / 2) \* 3</code></li></ul> <h2 id="命名和环境"><a href="#命名和环境" aria-hidden="true" class="header-anchor">#</a> 命名和环境</h2> <p>程序设计语言需要提供一种通过名字去使用对象的方式，<br>
我们将名字的标识符称为变量， 其对应的值称为对象。</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">ghci</span><span class="token operator">&gt;</span> <span class="token keyword">let</span> <span class="token hvariable">a</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token hvariable">ghci</span><span class="token operator">&gt;</span> <span class="token builtin">show</span> <span class="token hvariable">a</span>
<span class="token comment">-- =&gt; &quot;1&quot;</span>
</code></pre></div><p>我们之所以能够将符号和值关联，而后又能取出这些值，是因为解释器必须维护某种存储能力，以保持名字和值得关联关系。<br>
这种存储能力被称为环境（或者说是全局环境，一个计算过程可能会涉及到若干不同的环境）</p> <h2 id="组合式的求值"><a href="#组合式的求值" aria-hidden="true" class="header-anchor">#</a> 组合式的求值</h2> <p>组合式的求值解释器一般按照下面步骤求值：</p> <ul><li>求组合式各表达式的值</li> <li>求最左边表达式( 运算符 )应用于实际参数， 所谓的参数也就是其他表达式( 运算对象 )的值</li></ul> <p>通过这一递归的过程，我们可以简洁的描述嵌套深度的情况
反复应用第一个步骤，我们可以到达求值中不是复杂表达式的某一点，这里需要处理的是基本表达式，我们可以通过：</p> <ul><li>数的值就是它们表示的数值</li> <li>内部运算符的值，就是能够完成相应操作的机器指针序列</li> <li>其它名字的值，就是在这个环境中关联与这个名字的对象</li></ul> <p>其第二点可以看做是第三点的特殊情况，及 +, -, *, / 一类的运算符也包含在全局环境里，并将与之关联的指令序列作为它的 “值”。
其实环境的角色就是用于确定各个符号对应的意义。<br>
如果没有环境的任何信息，那么类似 <code>(x + 1)</code> 将没有任何意义，因为需要有环境为 <code>x</code> 提供意义(甚至是符号 <code>+</code> 的意义)</p> <p>对于像 let a = 1 这种我们称为 <code>特殊形式</code> 它并不是一个组合式</p> <h2 id="复合过程"><a href="#复合过程" aria-hidden="true" class="header-anchor">#</a> 复合过程</h2> <p>目前已经了解的对于程序设计语言的一些基本元素：</p> <ul><li>数和算术运算是最基本的数据和过程</li> <li>组合式的嵌套提供了一种组合起多个操作的方法</li> <li>定义一种受限的抽象手段，它为名字关联相应的值</li></ul> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">square</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">*</span> <span class="token hvariable">x</span>
<span class="token hvariable">ghci</span><span class="token operator">&gt;</span> <span class="token hvariable">square</span> <span class="token number">2</span>
<span class="token comment">-- =&gt; 4</span>
<span class="token hvariable">ghci</span><span class="token operator">&gt;</span> <span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment">-- =&gt; 8</span>
</code></pre></div><p>上面的过程称为过程定义，它一种更强大的抽象技术，通过它可以为复合操作提供名字，而后就可以像操作一样作为一个单元使用了,
我们还可以通过基本过程去定义复合过程：</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">sum_of_squares</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span> <span class="token operator">=</span> <span class="token hvariable">square</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token hvariable">y</span><span class="token punctuation">)</span>
<span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token operator">=</span> <span class="token hvariable">sum_of_squares</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="过程应用的代换模型-正则序，应用序"><a href="#过程应用的代换模型-正则序，应用序" aria-hidden="true" class="header-anchor">#</a> 过程应用的代换模型 - 正则序，应用序</h2> <p>对应复合过程应用的计算过程是：</p> <ul><li>将复合过程应用于实际参数，就是将过程体中形参对应的实参取代之后，对这一过程体求值</li></ul> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token operator">=&gt;</span> <span class="token hvariable">f</span> <span class="token number">5</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">sum_of_squares</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">sum_of_squares</span> <span class="token number">6</span> <span class="token number">10</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">square</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token number">10</span><span class="token punctuation">)</span>
<span class="token operator">=&gt;</span> <span class="token number">6</span><span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">10</span>
<span class="token operator">=&gt;</span> <span class="token number">136</span>
</code></pre></div><p>上面这一过程称为过程应用的<code>代换模型</code>，考虑到们之前定义的过程，我们可以将它看做过程应用 &quot;意义&quot; 的一种模型。需要注意的两点：</p> <ul><li>代换只是帮助了解调用的执行情况。并不是解释器的实际工作方式，通常解释器都不会直接修改过程正文，用代换形参的方式去完成调用，而是通过提供形参的局部环境的方式，完成&quot;代换&quot;效果</li> <li>一般来说，在模拟科学研究或者工程中的现象时，我们总是从最简单的不完全模型开始。随着更细致的检查说考虑的问题，这些简单模型会越来越不适和，从而需要用进一步的模型取代，代换模型也不例外。</li></ul> <h3 id="应用序和正则序"><a href="#应用序和正则序" aria-hidden="true" class="header-anchor">#</a> 应用序和正则序</h3> <p>解释器在求值是有两种不同的策略:<br>
第一种是先对各运算符和各对象求值，而后将得到的过程应用于得到的实际参数，这种方式称为 <code>应用序</code><br>
第二种先不求出个运算对象的值，等到实际需要他们的值的时候再去做，这种方式称为 <code>正则序</code></p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token comment">-- 正则序</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">f</span> <span class="token number">5</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">sum_of_squares</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">=&gt;</span> <span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token operator">=&gt;</span> <span class="token number">6</span><span class="token operator">*</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">10</span><span class="token operator">*</span><span class="token number">10</span>
<span class="token operator">=&gt;</span> <span class="token number">136</span>
</code></pre></div><p>大部分程序设计语言都采用了应用序，这样做能避免对应表达式的重复求值，从而可以提高一些效率。更重要的是，在超出了可以使用替换模拟的过程范围之后，正则序将变得很复杂。</p> <h2 id="条件表达式"><a href="#条件表达式" aria-hidden="true" class="header-anchor">#</a> 条件表达式</h2> <ul><li>if else</li> <li>and or</li></ul> <h3 id="test-1-5-解析"><a href="#test-1-5-解析" aria-hidden="true" class="header-anchor">#</a> test 1.5 解析</h3> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">p</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">p</span><span class="token punctuation">)</span>
<span class="token hvariable">test_p</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span>
  <span class="token operator">|</span> <span class="token hvariable">x</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">y</span>

<span class="token hvariable">test</span> <span class="token number">0</span> <span class="token punctuation">(</span><span class="token hvariable">p</span><span class="token punctuation">)</span>
<span class="token comment">-- 正则序会返回0</span>
<span class="token comment">-- 应用序会栈溢出</span>
</code></pre></div><p>正则序不会去调用 p 求值， 最后返回 0， 应用序会进入求 p 的无限循环，最后导致栈溢出</p> <h2 id="实例：采用牛顿法求平方根"><a href="#实例：采用牛顿法求平方根" aria-hidden="true" class="header-anchor">#</a> 实例：采用牛顿法求平方根</h2> <p>设 √x = y 使得 ， y ^ 2 = x<br>
函数与过程之间的矛盾在于，如何去描述一件事情的特征 与 描述如何去做这件事之间的差异的反应。<br>
在数学里人们关心是 说明性描述（是什么）， 而在计算机科学里人们关心的是 行动性描述（怎么做）</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">+</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span>

<span class="token hvariable">good_enough_1</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">guss</span> <span class="token operator">*</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.001</span>

<span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token hvariable">change_guss</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token hvariable">change_guss</span> <span class="token operator">-</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">&lt;</span> <span class="token number">0.00000001</span>

<span class="token hvariable">sqrt_iter</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Ord</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Floating</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">sqrt_iter</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span>
  <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">guss</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">sqrt_iter</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token hvariable">x</span>

<span class="token builtin">sqrt</span>' <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">sqrt_iter</span> <span class="token number">1</span> <span class="token hvariable">x</span>
</code></pre></div><h2 id="过程作为黑箱抽象"><a href="#过程作为黑箱抽象" aria-hidden="true" class="header-anchor">#</a> 过程作为黑箱抽象</h2> <p>一个过程定义（如 good_enough， improve），应该可以隐藏一些细节。 这使使用者不必自己去实现这一过程，而是从其他人那里作为一个黑箱接受它。用户在使用时，应该不需要去弄清它是如何实现的。</p> <h3 id="局部名"><a href="#局部名" aria-hidden="true" class="header-anchor">#</a> 局部名</h3> <p>过程用户不用关心实现细节之一，就是在过程里的形参是由实现者去选择的。 比如，下面两个过程定义就是无法区分的：</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">square</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">*</span> <span class="token hvariable">x</span>
<span class="token hvariable">square</span> <span class="token hvariable">y</span> <span class="token operator">=</span> <span class="token hvariable">y</span> <span class="token operator">*</span> <span class="token hvariable">y</span>
</code></pre></div><p>过程的形式参数的具体名字是什么，其实是没有什么关系。这样的名字称为<code>约束变量</code>，一个过程定义 约束了它的所有形参。如果在一个过程里将约束变量统一更名，过程的定义将不会有任何改变。<br>
与之相对的<code>自由变量</code>它是不被约束的。 一个名字的定义被约束于的那一级，我们就称这一级是这个变量的<code>作用域</code>.形参的作用域就是这一过程的过程体。</p> <h3 id="内部定义和块结构"><a href="#内部定义和块结构" aria-hidden="true" class="header-anchor">#</a> 内部定义和块结构</h3> <p>在一个有多个过程组成的程序里只有一个过程对用户很重要，我们允许一个过程里带有内部的定义，是他们是属于这一局部的过程，这种嵌套定义称为<code>块结构</code>。</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code>  <span class="token builtin">sqrt</span>' <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token keyword">let</span>
    <span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">+</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token hvariable">change_guss</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token hvariable">change_guss</span> <span class="token operator">-</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">&lt;</span> <span class="token number">0.00000001</span>
    <span class="token hvariable">sqrt_iter</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Ord</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Floating</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
    <span class="token hvariable">sqrt_iter</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span>
      <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">guss</span>
      <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">sqrt_iter</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token hvariable">x</span>
    <span class="token keyword">in</span> <span class="token hvariable">sqrt_iter</span> <span class="token number">1</span> <span class="token hvariable">x</span>
</code></pre></div><p>我们还可以将外部的约束变量作为内部自由变量来使用。 这种方式被称为<code>词法作用域</code>。</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token builtin">sqrt</span>' <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token keyword">let</span>
  <span class="token hvariable">improve</span> <span class="token hvariable">guss</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">+</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token hvariable">change_guss</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token hvariable">change_guss</span> <span class="token operator">-</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token hvariable">guss</span> <span class="token operator">&lt;</span> <span class="token number">0.00000001</span>
  <span class="token hvariable">sqrt_iter</span> <span class="token hvariable">guss</span>
    <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token hvariable">good_enough</span> <span class="token hvariable">guss</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">guss</span>
    <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">sqrt_iter</span> <span class="token punctuation">(</span><span class="token hvariable">improve</span> <span class="token hvariable">guss</span><span class="token punctuation">)</span>
  <span class="token keyword">in</span> <span class="token hvariable">sqrt_iter</span> <span class="token number">1</span>
</code></pre></div><h2 id="过程与他们所产生的计算"><a href="#过程与他们所产生的计算" aria-hidden="true" class="header-anchor">#</a> 过程与他们所产生的计算</h2> <p>一个过程也就是一种模式，它描述了一个计算过程的局部演化方式，描述了这一计算过程的每个步骤是怎么样基于前面的步骤建立起来的。</p> <h3 id="线性递归和迭代"><a href="#线性递归和迭代" aria-hidden="true" class="header-anchor">#</a> 线性递归和迭代</h3> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token comment">-- 求n的阶乘就是求 n * (n - 1) 的阶乘</span>
<span class="token comment">-- 其中 1 的阶乘为 1</span>

<span class="token hvariable">factorial</span>' <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">n</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">factorial</span>' <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">-- 执行过程</span>
<span class="token comment">-- factorial' 6</span>
<span class="token comment">-- 6 * factorial' 5</span>
<span class="token comment">-- 6 * 5 * factorial' 4</span>
<span class="token comment">-- ...</span>
<span class="token comment">-- 6 * 5 * 4 * 3 * 2 * factorial' 1</span>
<span class="token comment">-- 6 * 5 * 4 * 3 * 2 * 1</span>
<span class="token comment">-- 720</span>
</code></pre></div><p>使用代换模型可以发现这种计算过程呈现出，先逐步展开然后逐步收缩的形状。
在展开阶段里，计算过程构造出一个延迟执行的操作链条，在收缩阶段里表现为这些运算的实际执行。<br>
这种由推迟执行的运算链条所刻画的计算过程的类型，称为<code>递归计算过程</code></p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">fact_iter</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Ord</span> <span class="token hvariable">t</span><span class="token punctuation">,</span> <span class="token constant">Num</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span>
<span class="token hvariable">fact_iter</span> <span class="token builtin">product</span> <span class="token hvariable">counter</span> <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">counter</span> <span class="token operator">&gt;</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">product</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">fact_iter</span> <span class="token punctuation">(</span><span class="token builtin">product</span> <span class="token operator">*</span> <span class="token hvariable">counter</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">counter</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">n</span>

<span class="token hvariable">factorial</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Integral</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">factorial</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">fact_iter</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token hvariable">n</span>

<span class="token comment">-- 执行过程</span>
<span class="token comment">-- factorial 6</span>
<span class="token comment">-- fact_iter 1 1 6</span>
<span class="token comment">-- fact_iter 1 2 6</span>
<span class="token comment">-- fact_iter 2 3 6</span>
<span class="token comment">-- fact_iter 6 4 6</span>
<span class="token comment">-- fact_iter 24 5 6</span>
<span class="token comment">-- fact_iter 120 6 6</span>
<span class="token comment">-- fact_iter 720 7 6</span>
<span class="token comment">-- 720</span>
</code></pre></div><p>一般来说，其状态可以用固定数目的<code>状态变量</code>描述的计算过程；
同时又存在一套固定规则来描述计算过程在从一个状态到下一个状态转换时；
还有一个结束检测，它描述这一过程的终止条件。这种过程称为<code>线性迭代过程</code>。</p> <h3 id="树形递归"><a href="#树形递归" aria-hidden="true" class="header-anchor">#</a> 树形递归</h3> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">fibonacci</span>' <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">fibonacci</span>' <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token hvariable">fibonacci</span>' <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><p>该过程所用的计算步骤随着输入增长而呈指数型增长。</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">fibonacci_iter</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Eq</span> <span class="token hvariable">t</span><span class="token punctuation">,</span> <span class="token constant">Num</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span>
<span class="token hvariable">fibonacci_iter</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span> <span class="token hvariable">counter</span>
  <span class="token operator">|</span> <span class="token hvariable">counter</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">a</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">fibonacci_iter</span> <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token hvariable">b</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">counter</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>

<span class="token hvariable">fibonacci</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Num</span> <span class="token hvariable">t</span><span class="token punctuation">,</span> <span class="token constant">Eq</span> <span class="token hvariable">t</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">t</span> <span class="token operator">-&gt;</span> <span class="token hvariable">t</span>
<span class="token hvariable">fibonacci</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">fibonacci_iter</span> <span class="token number">0</span> <span class="token number">1</span> <span class="token hvariable">n</span>
</code></pre></div><p>也可以将前一个计算模式转换为上面的线性迭代过程，该过程相对于前一个过程，计算步骤呈指数型增长。<br>
虽然说树形递归较迭代过程比较低效，但是也能说其没用，因为树形递归比起迭代更加直接了当，它可以帮助我们理解和设计程序。</p> <h3 id="增长阶"><a href="#增长阶" aria-hidden="true" class="header-anchor">#</a> 增长阶</h3> <p>当我们在描述不同计算过程在消耗资源的速率上会采用<code>增长的阶</code>的记法，来粗略度量某一计算过程在输入变大的情况下所消耗的资源。<br>
令 n 作为问题规模的度量，令 R(n) 过程处理规模为 n 的问题所需要的资源量。例如，目标是平方根的近似值，那么n就是所需精度的数值个数，
对于矩阵乘法，n 就为矩阵的行数。<br>
我们称 R(n) 具有 <code>θ(f(n))</code> 的增长阶，记为 R(n) = θ(f(n)),如果存在与n无关的整数k1和k2使得：<br> <code>k1 * f(n) &lt;= R(n) &lt;= k2 * f(n)</code><br>
对于任何n值都成立，（即对于足够大的n， 值R(n) 总位于 <code>k1 * f(n)</code> 和 <code>k2 * f(n)</code> 之间）<br>
比如，计算阶乘的线性递归计算过程里，所需的步骤增长为θ(n), 空间的需求增长也为 θ(n); 对于迭代的阶乘，所需的步骤还是θ(n), 空间为θ(1)</p> <h3 id="求幂"><a href="#求幂" aria-hidden="true" class="header-anchor">#</a> 求幂</h3> <p>给出一个基数 b 和一个指数 n，求 b^n:</p> <ol><li>可以通过下面的方式<br> <code>b^n = b * b^(n-1)</code><br> <code>b^0 = 1</code></li></ol> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">power</span> <span class="token hvariable">b</span> <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">b</span> <span class="token operator">*</span> <span class="token hvariable">power</span> <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><p>这是一个线性的递归计算过程，需要 θ(n) 步和 θ(n) 空间。<br>
2. 可以将上面的方式改为线性迭代</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">power_iter</span>' <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token builtin">product</span>
<span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">product</span>
<span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">power_iter</span>' <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">product</span> <span class="token operator">*</span> <span class="token hvariable">b</span><span class="token punctuation">)</span>

<span class="token hvariable">power</span>' <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">power_iter</span>' <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token number">1</span>
</code></pre></div><p>步骤 θ(n), 空间 θ(1)<br>
3. 可以通过连续求平方的方式，减少计算步骤<br>
偶数 <code>b^n = (b^(n/2))^2</code><br>
奇数 <code>b^n = b * b^(n-1)</code></p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">square</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">*</span> <span class="token hvariable">x</span>
<span class="token hvariable">power</span>'' <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Integral</span> <span class="token hvariable">a1</span><span class="token punctuation">,</span> <span class="token constant">Integral</span> <span class="token hvariable">a2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a2</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a1</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a2</span>
<span class="token hvariable">power</span>'' <span class="token hvariable">b</span> <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">even</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token hvariable">power</span>'' <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token builtin">floor</span> <span class="token operator">$</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">b</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">power</span>'' <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>这一过程空间和步数上都是相对于n的对数，计算b^2n时只需多做一次乘法，即计算指数n所需要的乘法次数大约是以2为低n的对数值，记作θ(log n)<br>
4. 连续求平方的迭代方式</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">power_iter</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Integral</span> <span class="token hvariable">a1</span><span class="token punctuation">,</span> <span class="token constant">Integral</span> <span class="token hvariable">a2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a2</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a1</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a2</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a2</span>
<span class="token hvariable">power_iter</span> <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token hvariable">a</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">=</span> <span class="token hvariable">a</span><span class="token operator">*</span><span class="token hvariable">b</span>
  <span class="token operator">|</span> <span class="token builtin">even</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">power_iter</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token hvariable">b</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">floor</span> <span class="token operator">$</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">a</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">power_iter</span> <span class="token hvariable">b</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">a</span><span class="token operator">*</span><span class="token hvariable">b</span>

<span class="token hvariable">power_fast</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Integral</span> <span class="token hvariable">a1</span><span class="token punctuation">,</span> <span class="token constant">Integral</span> <span class="token hvariable">a2</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token hvariable">a2</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a1</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a2</span>
<span class="token hvariable">power_fast</span> <span class="token hvariable">b</span> <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">error</span> <span class="token string">&quot;N must &gt; 0&quot;</span>
  <span class="token operator">|</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">power_iter</span> <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token number">1</span>
</code></pre></div><p>步骤为 θ(log n), 空间 θ(1)</p> <blockquote><p>一般来说，定义好状态变换，使得从一个状态转换到另一个状态时说得的值不变，即定义了一个不变量，要求它在状态之间保持不变，这一技术是思考迭代算法设计时的一种强有力的方法。</p></blockquote> <h3 id="最大公约数"><a href="#最大公约数" aria-hidden="true" class="header-anchor">#</a> 最大公约数</h3> <p>两个整数a和b的最大公约数（GCD）定义为能除尽这两个数的最大整数,找出GCD的一般方法是因式分解，但是存在一个更高效的算法 <code>欧几里得算法</code>：<br> <code>GCD(a, b) = GCD(b, r)</code>
其中 r 为 a 除以 b 的余数</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token builtin">gcd</span>' <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span>
<span class="token builtin">gcd</span>' <span class="token hvariable">a</span> <span class="token hvariable">b</span>
  <span class="token operator">|</span> <span class="token hvariable">b</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">a</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token builtin">gcd</span>' <span class="token hvariable">b</span> <span class="token operator">$</span> <span class="token builtin">rem</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span>
</code></pre></div><p>步数具有 θ(log n) 的增长阶</p> <blockquote><p>有理数化简到最简形式时，需要同时除以他们的最大公约数，比如 16/28 =&gt; 4/7</p></blockquote> <h3 id="质数检测"><a href="#质数检测" aria-hidden="true" class="header-anchor">#</a> 质数检测</h3> <ol><li>查找最小质因数，步骤θ(sqrt n)</li></ol> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">prime</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">smallest_divisor</span> <span class="token hvariable">n</span> <span class="token operator">==</span> <span class="token hvariable">n</span>

<span class="token hvariable">smallest_divisor</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">find_divisor</span> <span class="token hvariable">n</span> <span class="token number">2</span>

<span class="token hvariable">find_divisor</span> <span class="token hvariable">n</span> <span class="token hvariable">test_divisor</span>
  <span class="token operator">|</span> <span class="token hvariable">square</span> <span class="token hvariable">test_divisor</span> <span class="token operator">&gt;</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">n</span>
  <span class="token operator">|</span> <span class="token builtin">rem</span> <span class="token hvariable">n</span> <span class="token hvariable">test_divisor</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">test_divisor</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">find_divisor</span> <span class="token hvariable">n</span> <span class="token operator">$</span> <span class="token hvariable">test_divisor</span> <span class="token operator">+</span> <span class="token number">1</span>

<span class="token hvariable">primes</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token hvariable">x</span><span class="token operator">|</span><span class="token hvariable">x</span> <span class="token operator">&lt;-</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">..</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token hvariable">prime</span> <span class="token hvariable">x</span><span class="token punctuation">]</span>
</code></pre></div><ol start="2"><li>费马检查，步骤 θ(log n)</li></ol> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">drawInt</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token constant">Integer</span>
<span class="token hvariable">drawInt</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span> <span class="token operator">=</span> <span class="token hvariable">getStdRandom</span> <span class="token punctuation">(</span><span class="token hvariable">randomR</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token punctuation">,</span><span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token hvariable">random_list</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">[</span><span class="token constant">Integer</span><span class="token punctuation">]</span>
<span class="token hvariable">random_list</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token hvariable">random_list</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token keyword">do</span>
    <span class="token hvariable">a</span> <span class="token operator">&lt;-</span> <span class="token hvariable">drawInt</span> <span class="token number">1</span> <span class="token number">20</span>
    <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token punctuation">(</span><span class="token hvariable">random_list</span><span class="token punctuation">(</span><span class="token hvariable">n</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">:</span> <span class="token hvariable">rest</span><span class="token punctuation">)</span>

<span class="token hvariable">expmod</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span>
<span class="token hvariable">expmod</span> <span class="token hvariable">base</span> <span class="token builtin">exp</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">exp</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">even</span> <span class="token builtin">exp</span> <span class="token operator">=</span> <span class="token builtin">rem</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token hvariable">expmod</span> <span class="token hvariable">base</span> <span class="token punctuation">(</span><span class="token builtin">floor</span> <span class="token operator">$</span> <span class="token builtin">fromIntegral</span> <span class="token builtin">exp</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token builtin">rem</span> <span class="token punctuation">(</span><span class="token hvariable">base</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">expmod</span> <span class="token hvariable">base</span> <span class="token punctuation">(</span><span class="token builtin">exp</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>

<span class="token hvariable">fermat_test</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token constant">Bool</span>
<span class="token hvariable">fermat_test</span> <span class="token hvariable">_</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token constant">True</span>
<span class="token hvariable">fermat_test</span> <span class="token hvariable">n</span> <span class="token hvariable">times</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token hvariable">a</span> <span class="token operator">&lt;-</span> <span class="token hvariable">drawInt</span> <span class="token number">1</span> <span class="token operator">$</span> <span class="token hvariable">n</span><span class="token operator">-</span><span class="token number">1</span>
  <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fermat_test</span> <span class="token hvariable">n</span> <span class="token operator">$</span> <span class="token hvariable">times</span> <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token builtin">return</span> <span class="token operator">$</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">expmod</span> <span class="token hvariable">a</span> <span class="token hvariable">n</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token hvariable">rest</span>

<span class="token hvariable">primes_fast</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token punctuation">[</span><span class="token constant">Integer</span><span class="token punctuation">]</span>
<span class="token hvariable">primes_fast</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token hvariable">primes_fast</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token keyword">do</span>
    <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token hvariable">primes_fast</span> <span class="token operator">$</span> <span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token hvariable">b</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fermat_test</span> <span class="token hvariable">n</span> <span class="token number">2</span>
    <span class="token keyword">let</span> <span class="token hvariable">list</span> <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token hvariable">b</span> <span class="token keyword">then</span> <span class="token hvariable">n</span><span class="token operator">:</span><span class="token hvariable">rest</span> <span class="token keyword">else</span> <span class="token hvariable">rest</span>
    <span class="token builtin">return</span> <span class="token hvariable">list</span>

</code></pre></div><ol start="3"><li>Miller-Rabin 检查</li></ol> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">expmod_improve</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span>
<span class="token hvariable">expmod_improve</span> <span class="token hvariable">base</span> <span class="token builtin">exp</span> <span class="token hvariable">m</span>
  <span class="token operator">|</span> <span class="token builtin">exp</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token number">1</span>
  <span class="token operator">|</span> <span class="token builtin">even</span> <span class="token builtin">exp</span> <span class="token operator">=</span> <span class="token keyword">if</span> <span class="token hvariable">x</span> <span class="token operator">/=</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token hvariable">x</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token builtin">rem</span> <span class="token punctuation">(</span><span class="token hvariable">base</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">expmod_improve</span> <span class="token hvariable">base</span> <span class="token punctuation">(</span><span class="token builtin">exp</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>
  <span class="token keyword">where</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">rem</span> <span class="token punctuation">(</span><span class="token hvariable">square</span> <span class="token punctuation">(</span><span class="token hvariable">expmod</span> <span class="token hvariable">base</span> <span class="token punctuation">(</span><span class="token builtin">floor</span> <span class="token operator">$</span> <span class="token builtin">fromIntegral</span> <span class="token builtin">exp</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">m</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token hvariable">m</span>

<span class="token hvariable">fermat_test_improve</span> <span class="token operator">::</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">Integer</span> <span class="token operator">-&gt;</span> <span class="token constant">IO</span> <span class="token constant">Bool</span>
<span class="token hvariable">fermat_test_improve</span> <span class="token hvariable">_</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token constant">True</span>
<span class="token hvariable">fermat_test_improve</span> <span class="token hvariable">n</span> <span class="token hvariable">times</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token hvariable">a</span> <span class="token operator">&lt;-</span> <span class="token hvariable">drawInt</span> <span class="token number">1</span> <span class="token operator">$</span> <span class="token hvariable">n</span><span class="token operator">-</span><span class="token number">1</span>
  <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fermat_test_improve</span> <span class="token hvariable">n</span> <span class="token operator">$</span> <span class="token hvariable">times</span> <span class="token operator">-</span> <span class="token number">1</span>
  <span class="token builtin">return</span> <span class="token operator">$</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token hvariable">expmod_improve</span> <span class="token hvariable">a</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">n</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token hvariable">rest</span>

<span class="token hvariable">search_for_primes_improve</span> <span class="token hvariable">_</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token builtin">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token hvariable">search_for_primes_improve</span> <span class="token hvariable">n</span> <span class="token hvariable">count</span> <span class="token operator">=</span> <span class="token keyword">do</span>
  <span class="token keyword">if</span> <span class="token builtin">even</span> <span class="token hvariable">n</span>
    <span class="token keyword">then</span> <span class="token keyword">do</span>
      <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token punctuation">(</span><span class="token hvariable">search_for_primes_improve</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">count</span><span class="token punctuation">)</span>
      <span class="token builtin">return</span> <span class="token hvariable">rest</span>
    <span class="token keyword">else</span> <span class="token keyword">do</span>
      <span class="token hvariable">is_prime</span> <span class="token operator">&lt;-</span> <span class="token hvariable">fermat_test_improve</span> <span class="token hvariable">n</span> <span class="token number">3</span>
      <span class="token keyword">if</span> <span class="token hvariable">is_prime</span>
        <span class="token keyword">then</span> <span class="token keyword">do</span>
          <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token hvariable">search_for_primes_improve</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">count</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
          <span class="token builtin">return</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">:</span> <span class="token hvariable">rest</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span> <span class="token keyword">do</span>
          <span class="token hvariable">rest</span> <span class="token operator">&lt;-</span> <span class="token hvariable">search_for_primes_improve</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">count</span>
          <span class="token builtin">return</span> <span class="token hvariable">rest</span>

</code></pre></div><h2 id="用高阶函数做抽象"><a href="#用高阶函数做抽象" aria-hidden="true" class="header-anchor">#</a> 用高阶函数做抽象</h2> <p>过程也就是一类抽象，它描述了对于数的复合操作，但又不依赖特定的数。比如：我们可以定义 <code>cube x = x * x * x</code> 它不是某一个数的立方，而是任意数得到立方的方法，而不是定义 <code>3*3*3, x*x*x</code> 这样的表达式, 这样使我们不用在语言提供的那些语言特定的基本操作的层面上工作。<br>
对强大的程序设计语言有一个必然的要求就是，能为公共模式命名，建立抽象，而后在抽象层次上工作。过程的定义就提供了这样能力，这就是为什么除了最简单的语言外，都包含过程定义的原因。</p> <p>然而如果将过程限制为只能以数作为参数，将会严重的限制我们的抽象能力。我们就需要构造这样的过程，它们以过程为参数，或者以过程作为返回值，这种能操作过程的过程我们称之为<code>高阶函数</code>。</p> <h3 id="过程作为参数"><a href="#过程作为参数" aria-hidden="true" class="header-anchor">#</a> 过程作为参数</h3> <p>对于计算类似 a到b之间的数求和、求立方和或者 <code>1/(1*3) + 1/(5*7) + 1/(9*11) + ...</code>,它们都共享着一种共同的基础模式：</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token builtin">sum</span>' <span class="token hvariable">term</span> <span class="token hvariable">a</span> <span class="token hvariable">next</span> <span class="token hvariable">b</span>
  <span class="token operator">|</span> <span class="token hvariable">a</span> <span class="token operator">&gt;</span> <span class="token hvariable">b</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">term</span> <span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token builtin">sum</span>' <span class="token hvariable">term</span> <span class="token punctuation">(</span><span class="token hvariable">next</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token hvariable">next</span> <span class="token hvariable">b</span>

<span class="token comment">-- 求 1-5 的和</span>
<span class="token comment">-- sum' id 1 succ 5</span>
<span class="token comment">-- 求 1-5 的立方和</span>
<span class="token comment">-- sum' cube 1 succ 5</span>
</code></pre></div><p>可以利用这一过程计算出PI</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">sum_pi</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token hvariable">pi_term</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token hvariable">pi_next</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token number">4</span>
  <span class="token keyword">in</span> <span class="token builtin">sum</span>' <span class="token hvariable">pi_term</span> <span class="token hvariable">a</span> <span class="token hvariable">pi_next</span> <span class="token hvariable">b</span>

<span class="token comment">-- 求得pi的近似值 (sum_pi 1 1000) * 8 =&gt; 3.139592655589783</span>
</code></pre></div><p>求定积分</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">integral</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span> <span class="token hvariable">dx</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token hvariable">add_dx</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">dx</span>
  <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token builtin">sum</span>' <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token hvariable">dx</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">add_dx</span> <span class="token hvariable">b</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token hvariable">dx</span>

<span class="token comment">-- integral cube 0 1 0.00001 =&gt; 0.24999999998662864 ≈ 1/4</span>
</code></pre></div><p>采用辛普森规则更精确的求定积分</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">integral</span>' <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Eq</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Integral</span> <span class="token hvariable">b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">b</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">integral</span>' <span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span> <span class="token hvariable">n</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token hvariable">h</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">b</span> <span class="token operator">-</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">n</span>
      <span class="token hvariable">f</span>' <span class="token hvariable">k</span>
        <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span>
        <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">==</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">b</span>
        <span class="token operator">|</span> <span class="token builtin">odd</span> <span class="token hvariable">k</span> <span class="token operator">=</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">k</span> <span class="token operator">*</span> <span class="token hvariable">h</span><span class="token punctuation">)</span>
        <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token hvariable">f</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">+</span> <span class="token builtin">fromIntegral</span> <span class="token hvariable">k</span> <span class="token operator">*</span> <span class="token hvariable">h</span><span class="token punctuation">)</span>
  <span class="token keyword">in</span> <span class="token hvariable">h</span> <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token builtin">sum</span>' <span class="token hvariable">f</span>' <span class="token number">1</span> <span class="token builtin">succ</span> <span class="token hvariable">n</span>

<span class="token comment">-- integral' cube 0 1 100 =&gt; 0.24999999999999992</span>
<span class="token comment">-- integral' cube 0 1 1000 =&gt; 0.2500000000000003</span>
</code></pre></div><p>通过公式 <code>PI/4 = 2*4*4*6*6*8 ../(3*3*5*5*7*7)</code> 计算PI</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token builtin">product</span>' <span class="token hvariable">term</span> <span class="token hvariable">a</span> <span class="token hvariable">next</span> <span class="token hvariable">b</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token hvariable">iter</span> <span class="token hvariable">a</span> <span class="token hvariable">result</span>
        <span class="token operator">|</span> <span class="token hvariable">a</span> <span class="token operator">&gt;</span> <span class="token hvariable">b</span> <span class="token operator">=</span> <span class="token hvariable">result</span>
        <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">iter</span> <span class="token punctuation">(</span><span class="token hvariable">next</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">result</span> <span class="token operator">*</span> <span class="token hvariable">term</span> <span class="token hvariable">a</span><span class="token punctuation">)</span>
  <span class="token keyword">in</span> <span class="token hvariable">iter</span> <span class="token hvariable">a</span> <span class="token number">1</span>

<span class="token hvariable">factorial</span>'' <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">product</span>' <span class="token builtin">id</span> <span class="token number">1</span> <span class="token builtin">succ</span> <span class="token hvariable">x</span>

<span class="token hvariable">product_pi</span> <span class="token hvariable">n</span> <span class="token operator">=</span> <span class="token builtin">product</span>' <span class="token punctuation">(</span><span class="token operator">\</span> <span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">square</span> <span class="token punctuation">(</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">2</span> <span class="token punctuation">(</span><span class="token operator">\</span> <span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token hvariable">n</span> <span class="token operator">*</span> <span class="token number">4</span>
<span class="token comment">-- product_pi 10000000 =&gt; 3.1415928106708866</span>
</code></pre></div><h3 id="用lambda构造过程"><a href="#用lambda构造过程" aria-hidden="true" class="header-anchor">#</a> 用lambda构造过程</h3> <p><code>(\x -&gt; x+1) 1 =&gt; 2</code> 使用lambda形式可以直接构造过程，不需要再定义辅助过程</p> <h3 id="过程作为一般性方法"><a href="#过程作为一般性方法" aria-hidden="true" class="header-anchor">#</a> 过程作为一般性方法</h3> <h3 id="通过区间折半寻找方程的根"><a href="#通过区间折半寻找方程的根" aria-hidden="true" class="header-anchor">#</a> 通过区间折半寻找方程的根</h3> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">is_close_enough</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span> <span class="token operator">=</span> <span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.000001</span>
<span class="token hvariable">is_positive</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token builtin">abs</span> <span class="token hvariable">x</span> <span class="token operator">==</span> <span class="token hvariable">x</span>
<span class="token hvariable">average</span> <span class="token hvariable">x</span> <span class="token hvariable">y</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">y</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span>

<span class="token hvariable">search</span> <span class="token hvariable">f</span> <span class="token hvariable">neg_point</span> <span class="token hvariable">pos_point</span>
  <span class="token operator">|</span> <span class="token hvariable">is_close_enough</span> <span class="token hvariable">neg_point</span> <span class="token hvariable">pos_point</span> <span class="token operator">=</span> <span class="token hvariable">midpoint</span>
  <span class="token operator">|</span> <span class="token hvariable">test_value</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">midpoint</span>
  <span class="token operator">|</span> <span class="token hvariable">is_positive</span> <span class="token hvariable">test_value</span> <span class="token operator">=</span> <span class="token hvariable">search</span> <span class="token hvariable">f</span> <span class="token hvariable">neg_point</span> <span class="token hvariable">midpoint</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">search</span> <span class="token hvariable">f</span> <span class="token hvariable">midpoint</span> <span class="token hvariable">pos_point</span>
  <span class="token keyword">where</span> <span class="token hvariable">midpoint</span> <span class="token operator">=</span> <span class="token hvariable">average</span> <span class="token hvariable">neg_point</span> <span class="token hvariable">pos_point</span>
        <span class="token hvariable">test_value</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">midpoint</span>

<span class="token hvariable">half_interval_method</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span>
  <span class="token operator">|</span> <span class="token hvariable">is_positive</span> <span class="token hvariable">a_value</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token hvariable">is_positive</span> <span class="token hvariable">b_value</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">search</span> <span class="token hvariable">f</span> <span class="token hvariable">b</span> <span class="token hvariable">a</span>
  <span class="token operator">|</span> <span class="token hvariable">is_positive</span> <span class="token hvariable">b_value</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token hvariable">is_positive</span> <span class="token hvariable">a_value</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token hvariable">search</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span> <span class="token hvariable">b</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token builtin">error</span> <span class="token punctuation">(</span><span class="token string">&quot;Value are not of opposite sign &quot;</span> <span class="token operator">++</span> <span class="token builtin">show</span> <span class="token hvariable">a</span> <span class="token operator">++</span> <span class="token string">&quot;,&quot;</span> <span class="token operator">++</span> <span class="token builtin">show</span> <span class="token hvariable">b</span><span class="token punctuation">)</span>
  <span class="token keyword">where</span> <span class="token hvariable">a_value</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">a</span>
        <span class="token hvariable">b_value</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">b</span>
<span class="token comment">-- half_interval_method sin 2 4 =&gt; 3.141592502593994</span>
<span class="token comment">-- half_interval_method (\x -&gt; x*x*x - 2*x - 3) 1 2 =&gt; 1.8932890892028809</span>
</code></pre></div><h3 id="寻找函数不动点"><a href="#寻找函数不动点" aria-hidden="true" class="header-anchor">#</a> 寻找函数不动点</h3> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">fixed_point</span> <span class="token operator">::</span> <span class="token punctuation">(</span><span class="token constant">Ord</span> <span class="token hvariable">a</span><span class="token punctuation">,</span> <span class="token constant">Fractional</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span> <span class="token operator">-&gt;</span> <span class="token hvariable">a</span>
<span class="token hvariable">fixed_point</span> <span class="token hvariable">f</span> <span class="token hvariable">guess</span>
  <span class="token operator">|</span> <span class="token hvariable">is_close_enough</span> <span class="token hvariable">guess</span> <span class="token hvariable">next</span> <span class="token operator">=</span> <span class="token hvariable">next</span>
  <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">fixed_point</span> <span class="token hvariable">f</span> <span class="token hvariable">next</span>
  <span class="token keyword">where</span> <span class="token hvariable">next</span> <span class="token operator">=</span> <span class="token hvariable">f</span> <span class="token hvariable">guess</span>

<span class="token comment">-- fixed_point cos 1 =&gt; 0.7390855263619245</span>
<span class="token comment">-- fixed_point (\x -&gt; sin x + cos x) 1 =&gt; 1.2587277968014188</span>

<span class="token comment">-- y^2 = x</span>
<span class="token comment">-- =&gt; y = x/y</span>
<span class="token comment">-- =&gt; y + y = x/y + y</span>
<span class="token comment">-- =&gt; y = (x/y + y)/2</span>
<span class="token comment">-- 求平方根</span>
<span class="token builtin">sqrt</span>'' <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">fixed_point</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">y</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">x</span><span class="token operator">/</span><span class="token hvariable">y</span> <span class="token operator">+</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre></div><p>通过求连分式<code>f=n1/(d1+(n2/(d2+(n3/d3+(...)))))</code>计算黄金分割率</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">cont_frac</span> <span class="token hvariable">n</span> <span class="token hvariable">d</span> <span class="token hvariable">k</span> <span class="token operator">=</span>
  <span class="token keyword">let</span> <span class="token hvariable">iter</span> <span class="token hvariable">k</span> <span class="token hvariable">frac</span>
        <span class="token operator">|</span> <span class="token hvariable">k</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">=</span> <span class="token hvariable">frac</span>
        <span class="token operator">|</span> <span class="token builtin">otherwise</span> <span class="token operator">=</span> <span class="token hvariable">iter</span> <span class="token punctuation">(</span><span class="token hvariable">k</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token hvariable">n</span> <span class="token hvariable">k</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token hvariable">d</span> <span class="token hvariable">k</span> <span class="token operator">+</span> <span class="token hvariable">frac</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">in</span> <span class="token hvariable">iter</span> <span class="token hvariable">k</span> <span class="token number">0</span>

<span class="token hvariable">cont_frac</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token number">12</span> <span class="token operator">=&gt;</span> <span class="token number">0.6180257510729613</span>
</code></pre></div><p>通过连分式求e</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token comment">-- d: 1,2,1,1,4,1,1,6,1,1,8,1,...</span>
<span class="token comment">-- n: 1,1,1,...</span>
<span class="token hvariable">e_cf</span> <span class="token hvariable">k</span> <span class="token operator">=</span> <span class="token hvariable">cont_frac</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token keyword">if</span> <span class="token builtin">rem</span> <span class="token hvariable">x</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">2</span> <span class="token keyword">then</span> <span class="token builtin">fromIntegral</span> <span class="token operator">$</span> <span class="token builtin">div</span> <span class="token hvariable">x</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token keyword">else</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token hvariable">k</span> <span class="token operator">+</span> <span class="token number">2</span>
</code></pre></div><h3 id="过程作为返回值"><a href="#过程作为返回值" aria-hidden="true" class="header-anchor">#</a> 过程作为返回值</h3> <p>在通过不动点函数求平方根时，我们采用了平均阻尼的方式，它可以表述为</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">average_damp</span> <span class="token hvariable">f</span> <span class="token operator">=</span> <span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">average</span> <span class="token hvariable">x</span> <span class="token punctuation">(</span><span class="token hvariable">f</span> <span class="token hvariable">x</span><span class="token punctuation">)</span>
</code></pre></div><p>利用平均阻尼函数可以大大简化求平均根过程</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">sqrt_damp</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">fixed_point</span> <span class="token punctuation">(</span><span class="token hvariable">average_damp</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">y</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span> <span class="token operator">/</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre></div><p>这一过程将三种思想结合在一个函数里: 不动点搜寻、平均阻尼、\y-&gt;x/y ,通过抽象该过程的想法变得更加清晰</p> <p>一般来说将一个计算过程形式化为一个过程，存在着很多不同的方式，我们应该知道如何选择过程的形式，时期更容易理解，是该计算过程中有用的元素能表现为一些相互分离的个体，并使它们可能重新用于其它的应用。<br>
比如我们可以应用求立方根的函数<code>\x-&gt;y/(x*x)</code>:</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token hvariable">cube_root</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">fixed_point</span> <span class="token punctuation">(</span><span class="token hvariable">average_damp</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">y</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span> <span class="token operator">/</span> <span class="token hvariable">square</span> <span class="token hvariable">y</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre></div><h3 id="牛顿法"><a href="#牛顿法" aria-hidden="true" class="header-anchor">#</a> 牛顿法</h3> <p>如果x |-&gt; g(x) 是一个可微函数，那么方程g(x) = 0的一个解就是函数 x |-&gt; f(x) 的不动点，其中:<br> <code>f(x)=x-g(x)/Dg(x)</code><br>
这里的Dg(x)是对g(x)求导。 牛顿法就是利用前面的不动点方法，通过搜寻函数f的不动点，去逼近上述方程的解<br>
对于其中的导数，一般而言如果g(x) 是个函数而 dx 是一个很小的数，那么g的导数在任意数值x的值由下面的函数给出：</p> <p>Dg(x) = (g(x +dx) - g(x)) / dx</p> <p>可以描述为</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token comment">-- 求导</span>
<span class="token hvariable">deriv</span> <span class="token hvariable">g</span> <span class="token operator">=</span> <span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token hvariable">g</span> <span class="token punctuation">(</span><span class="token hvariable">x</span> <span class="token operator">+</span> <span class="token hvariable">dx</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token hvariable">g</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token hvariable">dx</span>
  <span class="token keyword">where</span> <span class="token hvariable">dx</span> <span class="token operator">=</span> <span class="token number">0.00001</span>
<span class="token comment">-- deriv cube 5 =&gt;  3 * 5 ^ 2 = 75</span>
</code></pre></div><p>牛顿法</p> <div class="language-haskell extra-class"><pre class="language-haskell"><code><span class="token comment">-- 牛顿法</span>
<span class="token hvariable">newton_transform</span> <span class="token hvariable">g</span> <span class="token operator">=</span> <span class="token operator">\</span><span class="token hvariable">x</span> <span class="token operator">-&gt;</span> <span class="token hvariable">x</span> <span class="token operator">-</span> <span class="token hvariable">g</span> <span class="token hvariable">x</span> <span class="token operator">/</span> <span class="token hvariable">deriv</span> <span class="token hvariable">g</span> <span class="token hvariable">x</span>
<span class="token hvariable">newton_method</span> <span class="token hvariable">g</span> <span class="token hvariable">guess</span> <span class="token operator">=</span> <span class="token hvariable">fixed_point</span> <span class="token punctuation">(</span><span class="token hvariable">newton_transform</span> <span class="token hvariable">g</span><span class="token punctuation">)</span> <span class="token hvariable">guess</span>

<span class="token hvariable">sqrt_newton</span> <span class="token hvariable">x</span> <span class="token operator">=</span> <span class="token hvariable">newton_method</span> <span class="token punctuation">(</span><span class="token operator">\</span><span class="token hvariable">y</span> <span class="token operator">-&gt;</span> <span class="token hvariable">square</span> <span class="token hvariable">y</span> <span class="token operator">-</span> <span class="token hvariable">x</span><span class="token punctuation">)</span> <span class="token number">1</span>
</code></pre></div><h3 id="抽象和第一级过程"><a href="#抽象和第一级过程" aria-hidden="true" class="header-anchor">#</a> 抽象和第一级过程</h3> <p>通过复合过程我们将一般性方法，用程序设计语言里的元素明确描述。<br>
通过高阶函数我们能够去操作这些一般性方法，以建立进一步的抽象</p> <p>作为编程者，我们应该对这一类可能性保持高度敏感，设法从中识别出程序里的基本抽象
基于它们去进一步构造，并扩展它们以建立进一步的抽象<br>
但是并不是说一定要用抽象的形式去写程序，而是要根据实际情况选择合适的抽象层次</p> <p>一般而言，程序设计语言总会对计算元素可使用的方式强加上某些限制。带有最少限制的元素被称为具有第一级状态。
第一级元素的 某些权利或特权包括：</p> <ul><li>可以用变量命名</li> <li>可以提供给过程作为参数</li> <li>可以有过程作为结果返回</li> <li>可以包含在数据结构中</li></ul> <p>对于将第一级状态给予过程的语言，它所获得的描述的能力确实及其惊人的。</p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/computer-program/" class="prev router-link-active">
          计算机程序构造和解释
        </a></span> <span class="next"><a href="/computer-program/02.abstraction-data-building.html">
          构造数据抽象
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.67e7f428.js" defer></script><script src="/assets/js/3.1660a1d9.js" defer></script>
  </body>
</html>
